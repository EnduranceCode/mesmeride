<div id='surface-container'>
  <canvas id='surface'></canvas>
</div>

<div class='footbox'>
  <%= form_for @route do |f| %>
    <div class='footdiv' id='waypoints'>
      <h3>Waypoints</h3>
      <table>
      <thead>
        <tr><th>Name</th><th>Distance</th></tr>
      </thead>
      <tbody>
         <!--@route.waypoints.each do |waypoint|  -->
          <%= f.fields_for :waypoints do |wf| %>
            <% render :partial => 'waypoint', :locals => { :f => wf } %>
          <% end %>
        <!-- end -->
        <!-- render @route.waypoints -->
        </tbody>
      </table>
      
      <%= add_child_link "Add Waypoint", :waypoints ,'btn btn-small' %></p>
      <%= new_child_fields_template f, :waypoints %>
    </div><div class='footdiv' id='tools'>
      <h3>Tools [template,rotate,render-specific,etc]</h3>
      <%= f.label :name %>
      <%= f.text_field :name %>
      <table>
        <tr><td id='size-little'>Little</td><td><%= f.hidden_field :zoom %><div class='size-slider' id='zoom-slider' data-value='<%= f.object.zoom %>'></div></td><td id='size-big'>Big</td></tr>
        <tr><td id-'x-quick'>Quick spin</td><td><%= f.hidden_field :x_scale %><div class='size-slider' id='scale-slider' data-value='<%= f.object.x_scale %>'></div></td><td id='x-epic'>Epic</td></tr>
        <% if rand <= 0.5
          r = ['Molehills','Mountains'] 
        else 
          r = ['Netherlands','Switzerland']
        end %>
        <tr><td id='y-molehills'><%= r[0] %></td><td><%= f.hidden_field :y_scale %><div class='size-slider' id='y-slider' data-value='<%= f.object.y_scale %>'></div></td><td id='y-mountains'><%= r[1] %></td></tr>
      </table>
    </div><div class='footdiv' id='controls'>
      <h3>Controls</h3>
      <div><%= button_tag "Export to PNG", :id => 'export-button', :type => 'button' %></div>
      <div><%= button_tag "Save Route", :id => 'save-button', :type => 'button' %></div>
    </div>
  <% end %>
</div>  
<div id='bottom-anchor'></div>

<script>
  var streams = <%= raw @route.streams %>;
  var waypoints = <%= raw @route.waypoints.to_json %>;
</script>

<div id='jstemplates'>
  <table>
    <%= yield :jstemplates %>
  </table>
  <%= form_tag 'image_save', :id => 'image_save' do %>
    <%= text_area_tag :data %>
    <%= text_field_tag :name %>
  <% end %>
</div>

<!--  javascript_include_tag "giro_renderer", "data-turbolinks-track" => true  -->
